<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VietTarot - Trang Chủ</title>

    <link rel="icon" type="image/png" sizes="16x16" href="https://www.viettarot.com/image/iconlogo.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://www.viettarot.com/image/iconlogo.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://www.viettarot.com/image/iconlogo.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        /* Biến màu và font chữ toàn cục */
        :root {
            --primary-blue: #4A6CF3;
            --primary-purple: #9B49F2;
            --text-primary: #1A1229;
            --text-secondary: #5A6474;
            --bg-white: #FFFFFF;
            --bg-off-white: #F8F7FA;
            --border-color: #E5E7EB;
            --danger-color: #dc3545;
            --warning-color: #FFC107;
            --success-color: #198754;
            --gradient-primary: linear-gradient(90deg, var(--primary-blue) 0%, var(--primary-purple) 100%);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-white);
            color: var(--text-primary);
        }

        /* Preloader */
        #preloader {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: var(--bg-white);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: opacity 0.75s ease, visibility 0.75s ease;
            opacity: 1;
            visibility: visible;
        }
        #preloader.fade-out {
            opacity: 0;
            visibility: hidden;
        }
        .preloader-content {
            text-align: center;
        }
        .loader {
            width: 60px; height: 60px;
            border: 5px solid var(--primary-blue);
            border-top-color: var(--primary-purple);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        .loading-text {
            margin-top: 1rem;
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--text-secondary);
            letter-spacing: 1px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* == CSS DÀNH RIÊNG CHO CÁC PHẦN CỦA TRANG CHỦ == */

        /* Hero Slider */
        #header-placeholder{
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        #heroSlider {
            padding: 0;
            margin: 0;
        }
        .carousel-item {
            height: 85vh;
            min-height: 500px;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }
        .carousel-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(26, 18, 41, 0.5);
        }
        .carousel-caption {
            bottom: 0;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            text-align: center;
        }
        @keyframes fadeInDown {
            from { opacity: 0; transform: translate3d(0, -50px, 0); }
            to { opacity: 1; transform: translate3d(0, 0, 0); }
        }
        .carousel-item.active .carousel-caption h1 { animation: fadeInDown 1s both; }
        .carousel-item.active .carousel-caption p { animation: fadeInDown 1s both 0.3s; }
        .carousel-item.active .carousel-caption .btn { animation: fadeInDown 1s both 0.6s; }
        .carousel-caption h1 {
            font-weight: 700;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.6);
        }
        .carousel-caption p {
            font-size: 1.25rem;
            color: var(--bg-off-white);
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.6);
        }
        .carousel-control-prev-icon,
        .carousel-control-next-icon {
            background-color: rgba(26, 18, 41, 0.5);
            border-radius: 50%;
            padding: 1.5rem;
            background-size: 50%;
        }
        .carousel-indicators {
            margin-bottom: 1rem;
        }
        .carousel-indicators [data-bs-target] {
            width: 12px; height: 12px;
            border-radius: 50%;
            background-color: var(--bg-white);
            opacity: 0.7;
            margin: 0 8px;
            transition: all 0.3s ease;
            position: relative;
            border: none;
            padding: 0;
        }
        .carousel-indicators .active {
            opacity: 1;
            background-color: transparent;
        }
        .carousel-indicators .active::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            border-radius: 50%;
            background: var(--gradient-primary);
        }
        
        /* Section chung */
        .animate-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
            will-change: opacity, transform;
        }
        .animate-on-scroll.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
        .section-title {
            font-weight: 700;
            color: var(--text-primary);
        }
        .section-subtitle {
            color: var(--text-secondary);
        }
        .section-heading {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 2rem;
        }

        /* Services Section */
        #services {
            background-color: var(--bg-off-white);
            position: relative;
            overflow: hidden;
        }
        .service-item-wrapper {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            height: 100%;
            justify-content: space-between;
        }
        .service-item {
            background-color: var(--bg-white);
            padding: 1.5rem;
            border-radius: 1rem;
            border: 1px solid var(--border-color);
            transition: box-shadow 0.3s ease, transform 0.3s ease;
            display: flex;
            gap: 1.25rem;
            align-items: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.03), 0 2px 4px -2px rgba(0, 0, 0, 0.03);
        }
        .service-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .service-item.text-lg-end {
            flex-direction: row-reverse;
        }
        .service-icon {
            flex-shrink: 0;
            width: 60px; height: 60px;
            background: var(--gradient-primary);
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.75rem;
            color: var(--bg-white);
        }
        .service-content h5 {
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        .service-content p {
            margin-bottom: 0;
            color: var(--text-secondary);
            font-size: 0.95rem;
        }
        .central-image-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
        }
        .central-hand-image {
            max-width: 100%;
            max-height: 100%;
            height: auto;
            width: auto;
            object-fit: contain;
            transition: transform 0.4s ease;
            border-radius: 1rem;
        }
        .central-hand-image:hover {
            transform: scale(1.05);
        }


        /* Courses Section */
        .badge-new {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--bg-white);
            background: var(--gradient-primary);
            border-radius: 6px;
            text-transform: uppercase;
            line-height: 1.2;
        }
        .course-card {
            background-color: var(--bg-white);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            overflow: hidden;
            transition: all 0.3s ease-in-out;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .course-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .course-card-thumbnail {
            display: block;
            position: relative;
            line-height: 0;
            overflow: hidden;
        }
        .course-card-thumbnail img {
            width: 100%;
            height: auto;
            transition: transform 0.3s ease;
        }
        .course-card:hover .course-card-thumbnail img {
            transform: scale(1.05);
        }
        .course-card .crown-icon {
            position: absolute;
            top: 1rem; left: 1rem;
            font-size: 0.9rem;
            width: 32px; height: 32px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #FFD700;
            z-index: 2;
        }
        .course-card-body {
            padding: 1.25rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .course-card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
            line-height: 1.5;
            min-height: 3.3em;
        }
        .course-card-title a {
            color: inherit;
            text-decoration: none;
            transition: color 0.3s ease;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .course-card-title a:hover {
            color: var(--primary-blue);
        }
        .course-card-price {
            text-align: right;
        }
        .course-card-price .original-price {
            text-decoration: line-through;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-right: 0.5rem;
        }
        .course-card-price .sale-price {
            font-weight: 700;
            color: var(--danger-color);
            font-size: 1.1rem;
        }
        .course-card-price .sale-price.text-success {
            color: var(--success-color) !important;
        }
        .course-card-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        .course-card-meta .info-item {
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        /* Testimonials Section */
        #testimonials {
            background-color: var(--bg-off-white);
        }
        .testimonial-card {
            background-color: var(--bg-white);
            border-radius: 1rem;
            border: 1px solid var(--border-color);
            height: 100%;
            display: flex;
            flex-direction: column;
            position: relative;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            text-align: center;
            margin-top: 45px;
            padding: 0;
        }
        .testimonial-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .testimonial-avatar {
            width: 90px; height: 90px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--bg-white);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            position: absolute;
            top: -45px; left: 50%;
            transform: translateX(-50%);
            z-index: 5;
        }
        .testimonial-content {
            padding: 3.5rem 1.5rem 1.5rem 1.5rem;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }
        .testimonial-header { margin-bottom: 1rem; }
        .testimonial-name {
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
            font-size: 1.1rem;
        }
        .testimonial-info {
            font-size: 0.9rem;
            color: var(--primary-purple);
            margin-bottom: 0.75rem;
        }
        .testimonial-rating {
            display: flex;
            gap: 0.25rem;
            font-size: 0.9rem;
            color: var(--warning-color);
            justify-content: center;
        }
        .testimonial-body {
            font-style: italic;
            color: var(--text-secondary);
            margin-bottom: 0;
            flex-grow: 1;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        .testimonial-quote-mark {
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            color: var(--primary-blue);
            margin-right: 0.5rem;
            font-size: 1rem;
        }
        .testimonials-slider .swiper-button-prev,
        .testimonials-slider .swiper-button-next {
            color: var(--primary-blue);
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            width: 44px; height: 44px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .testimonials-slider .swiper-button-prev:hover,
        .testimonials-slider .swiper-button-next:hover {
            color: var(--bg-white);
            background: var(--gradient-primary);
        }
        .testimonials-slider .swiper-button-prev::after,
        .testimonials-slider .swiper-button-next::after {
            font-size: 1rem;
            font-weight: 700;
        }
        .testimonials-slider .swiper-pagination-bullet {
            width: 10px; height: 10px;
            background-color: var(--text-secondary);
            opacity: 0.5;
            transition: all 0.3s ease;
        }
        .testimonials-slider .swiper-pagination-bullet-active {
            opacity: 1;
            background: var(--gradient-primary);
            transform: scale(1.2);
        }
        .testimonials-slider .swiper-pagination {
            position: static;
            margin-top: 3rem;
        }
        
        /* Promotion Popup */
        .promo-popup-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(26, 18, 41, 0.75);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }
        .promo-popup-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .promo-popup-content {
            position: relative;
            background-color: var(--bg-white);
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 650px;
            aspect-ratio: 4 / 3; 
            transform: scale(0.8);
            transition: transform 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);
        }
        .promo-popup-overlay.show .promo-popup-content {
            transform: scale(1);
        }
        .promo-popup-content #promo-image-link {
            display: block;
            width: 100%; height: 100%;
        }
        .promo-popup-content img {
            width: 100%; height: 100%;
            object-fit: cover;
        }
        .promo-popup-close {
            position: absolute;
            top: 10px; right: 10px;
            width: 36px; height: 36px;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 24px;
            line-height: 36px;
            text-align: center;
            cursor: pointer;
            z-index: 10;
            transition: background-color 0.3s ease;
        }
        .promo-popup-close:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }
        
        .promo-popup-button {
            position: absolute;
            bottom: 1.5rem;
            right: 1.5rem;
            z-index: 5;
            padding: 0.6rem 1.2rem;
            background: var(--gradient-primary);
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            border-radius: 50px;
            text-decoration: none;
            box-shadow: 0 4px 15px rgba(74, 108, 243, 0.3);
            transition: all 0.3s ease;
            display: none;
        }
        .promo-popup-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(155, 73, 242, 0.4);
        }

        /* Responsive cho trang chủ */
        @media (max-width: 767.98px) {
            .carousel-item { height: 60vh; min-height: 450px; }
            .carousel-control-prev-icon, .carousel-control-next-icon { padding: 1rem; background-size: 60%; }
            .carousel-indicators { bottom: 20px; }
            .carousel-caption { width: 90%; bottom: 60px; top: auto; transform: translateX(-50%); }
            .carousel-caption h1 { font-size: 2rem; margin-bottom: 0.75rem; }
            .carousel-caption p { font-size: 0.95rem; line-height: 1.4; margin-bottom: 1rem; }
            .carousel-caption .btn { padding: 0.5rem 1rem; font-size: 0.9rem; }
            .service-item { text-align: left !important; }
            .service-item.text-lg-end { flex-direction: row; }
            .testimonials-slider .swiper-button-prev,
            .testimonials-slider .swiper-button-next { display: none; }
            .promo-popup-button {
                bottom: 1rem;
                right: 1rem;
                padding: 0.5rem 1rem;
                font-size: 0.8rem;
            }
        }
        @media (max-width: 991.98px) {
             .central-hand-image { max-width: 250px; margin: 2rem 0; }
        }
        @media (max-width: 576px) {
            .promo-popup-content { max-width: 90vw; }
            .promo-popup-close { width: 32px; height: 32px; font-size: 20px; line-height: 32px; }
        }
    </style>
</head>

<body>
    <div id="preloader">
        <div class="preloader-content">
            <div class="loader"></div>
            <div class="loading-text">Đang tải...</div>
        </div>
    </div>

    <div id="header-placeholder"></div>

    <main>
        <div id="heroSlider" class="carousel slide">
            <div class="carousel-indicators" id="slider-indicators"></div>
            <div class="carousel-inner" id="slider-inner">
                <div class="carousel-item active" style="background-image: url('https://placehold.co/1920x800/1A1229/FFFFFF?text=Loading...')">
                    <div class="carousel-caption">
                        <h1>Đang tải dữ liệu...</h1>
                    </div>
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#heroSlider" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#heroSlider" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
        
        <section id="services" class="py-5">
            <div class="container py-4">
                <div class="row mb-5 text-center">
                    <div class="col-lg-8 mx-auto">
                        <h2 class="section-title">Dịch Vụ Của Chúng Tôi</h2>
                        <p class="section-subtitle lead">Khám phá các dịch vụ huyền học đa dạng được thiết kế để soi sáng và dẫn lối cho hành trình của bạn.</p>
                    </div>
                </div>
                <div class="row align-items-stretch">
                    <div class="col-lg-4 col-md-6">
                        <div class="service-item-wrapper">
                            <div class="service-item text-lg-end"><div class="service-content"><h5>Tài liệu độc quyền</h5><p>Tài liệu độc quyền do VietTarot phát hành sưu tầm.</p></div><div class="service-icon"><i class="fas fa-book-open"></i></div></div>
                            <div class="service-item text-lg-end"><div class="service-content"><h5>Bài viết bổ ích</h5><p>Sưu tầm và phát hành những bài hữu ích và giá trị.</p></div><div class="service-icon"><i class="fas fa-gem"></i></div></div>
                            <div class="service-item text-lg-end"><div class="service-content"><h5>Cộng đồng lớn mạnh</h5><p>Cộng đồng Reader lớn sẵn sàng hỗ trợ bạn.</p></div><div class="service-icon"><i class="fas fa-compass"></i></div></div>
                        </div>
                    </div>
                    <div class="col-lg-4 d-none d-lg-block central-image-container">
                        <img src="https://res.cloudinary.com/dq2n27klh/image/upload/v1756967825/_DL17332_ziq5ax.jpg" alt="ảnh ở giữa" class="central-hand-image" id="service-image">
                    </div>
                    <div class="col-lg-4 col-md-6 mt-4 mt-md-0">
                        <div class="service-item-wrapper">
                            <div class="service-item"><div class="service-icon"><i class="fas fa-heart-pulse"></i></div><div class="service-content"><h5>Khoá học chất lượng</h5><p>Sự kết hợp cả lý thuyết lẫn thực hành.</p></div></div>
                            <div class="service-item"><div class="service-icon"><i class="fas fa-calculator"></i></div><div class="service-content"><h5>Kiến thức nâng cao</h5><p>Tiếp xúc với các phương pháp thực thi mới lạ.</p></div></div>
                            <div class="service-item"><div class="service-icon"><i class="fas fa-moon"></i></div><div class="service-content"><h5>Hỗ trợ và bảo hành</h5><p>Hỗ trợ 24/7 cơ hội làm CTV của VietTarot.</p></div></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="featured-courses" class="py-5 bg-white">
            <div class="container py-4">
                <div class="section-heading">
                    <h2 class="section-title">Khóa học Pro</h2>
                    <span class="badge-new">Mới</span>
                </div>
                <div class="row g-4" id="courses-list">
                    <div class="col-12 text-center"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div><p class="mt-2">Đang tải các khóa học...</p></div>
                </div>
            </div>
        </section>

        <section id="testimonials" class="py-5">
            <div class="container py-4">
                <div class="row mb-5 text-center">
                    <div class="col-lg-8 mx-auto">
                        <h2 class="section-title">Học Viên Nói Gì Về Chúng Tôi</h2>
                        <p class="section-subtitle lead">Những chia sẻ chân thực từ các học viên đã đồng hành cùng VietTarot trên con đường khai phá tri thức.</p>
                    </div>
                </div>
                <div class="swiper testimonials-slider">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide"><div class="testimonial-card"><img src="https://kynguyenlamdep.com/wp-content/uploads/2022/08/anh-trai-dep-selfie-che-mat.jpg" alt="Avatar học viên Trần Minh Anh" class="testimonial-avatar"><div class="testimonial-content"><div class="testimonial-header"><h6 class="testimonial-name">Trần Minh Anh</h6><p class="testimonial-info">Học viên Tarot Nâng Cao</p><div class="testimonial-rating"><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></div></div><p class="testimonial-body"><i class="fas fa-quote-left testimonial-quote-mark"></i>Khóa học Tarot Nâng Cao thực sự vượt ngoài mong đợi của mình. Kiến thức chuyên sâu và cách giảng viên Linh Chi truyền đạt rất lôi cuốn.</p></div></div></div>
                        <div class="swiper-slide"><div class="testimonial-card"><img src="https://static-images.vnncdn.net/files/publish/2023/4/21/1-trung-tadashi-1530.jpg" alt="Avatar học viên Lê Hoàng Bách" class="testimonial-avatar"><div class="testimonial-content"><div class="testimonial-header"><h6 class="testimonial-name">Lê Hoàng Bách</h6><p class="testimonial-info">Học viên Tarot Vỡ Lòng</p><div class="testimonial-rating"><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></div></div><p class="testimonial-body"><i class="fas fa-quote-left testimonial-quote-mark"></i>Mình chưa biết gì về Tarot nhưng khóa học này rất dễ hiểu. Giờ mình đã tự tin giải những trải bài đơn giản cho bản thân và bạn bè. Rất khuyến khích!</p></div></div></div>
                        <div class="swiper-slide"><div class="testimonial-card"><img src="https://tiki.vn/blog/wp-content/uploads/2023/01/oLkoHpw9cqRtLPTbg67bgtUvUdV1BnXRnAqqBZOVkEtPgf-_Ct3ADFJYXIjfDd0fTyECLEsWq5yZ2CCOEGxIsuHSmNNNUZQcnQT5-Ld6yoK19Q_Sphb0MmX64ga-O_TIPjItNkTL5ns4zqP1Z0OBzsIoeYKtcewnrjnVsw8vfG8uYwwCDkXaoozCrmH1kA.jpg" alt="Avatar khách hàng Phạm Thu Hà" class="testimonial-avatar"><div class="testimonial-content"><div class="testimonial-header"><h6 class="testimonial-name">Phạm Thu Hà</h6><p class="testimonial-info">Khách hàng xem Tarot</p><div class="testimonial-rating"><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star-half-alt"></i></div></div><p class="testimonial-body"><i class="fas fa-quote-left testimonial-quote-mark"></i>Dịch vụ tư vấn Chiêm tinh rất chuyên nghiệp. Bản phân tích chi tiết đã giúp mình định hướng được nhiều điều trong công việc và cuộc sống.</p></div></div></div>
                        <div class="swiper-slide"><div class="testimonial-card"><img src="https://tse3.mm.bing.net/th/id/OIF.TJYcUCKu0T4DzoLIVdCmoQ?pid=Api&P=0&h=220" alt="Avatar thành viên Nguyễn Thị Mai" class="testimonial-avatar"><div class="testimonial-content"><div class="testimonial-header"><h6 class="testimonial-name">Nguyễn Thị Mai</h6><p class="testimonial-info">Thành viên cộng đồng</p><div class="testimonial-rating"><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></div></div><p class="testimonial-body"><i class="fas fa-quote-left testimonial-quote-mark"></i>Thật tuyệt vời! Cộng đồng VietTarot rất sôi nổi và luôn sẵn sàng giúp đỡ những người mới như mình. Cảm ơn VietTarot rất nhiều!</p></div></div></div>
                    </div>
                    <div class="swiper-pagination"></div>
                    <div class="swiper-button-prev"></div>
                    <div class="swiper-button-next"></div>
                </div>
            </div>
        </section>
    </main>

    <div id="footer-placeholder"></div>
    
    <div id="modals-placeholder"></div>
    
    <div id="floating-widgets-placeholder"></div>

    <div id="promotionPopup" class="promo-popup-overlay">
        <div class="promo-popup-content">
            <button id="closePromoPopup" class="promo-popup-close" title="Đóng">&times;</button>
            <a href="#" target="_blank" id="promo-image-link">
                <img src="https://placehold.co/650x488/1A1229/FFFFFF?text=Loading+Promo..." alt="Quảng cáo khuyến mãi" id="promo-image">
            </a>
            <a href="#" target="_blank" id="promo-button" class="promo-popup-button"></a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    
    <script src="components.js"></script> 
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const supabase = window.viettarotApp.supabase;
            if (!supabase) {
                console.error("Supabase client not found. Make sure components.js is loaded correctly.");
                return;
            }

            // =====================================================================
            // ===== LOGIC DÀNH RIÊNG CHO TRANG INDEX.HTML (SLIDER, COURSES, ETC.) =====
            // =====================================================================

            async function loadServiceImage() {
                const { data, error } = await supabase.from('website_settings').select('service_image_url').eq('id', 1).single();
                if (error) { console.error('Lỗi khi tải ảnh dịch vụ:', error.message); }
                if (data) {
                    const serviceImage = document.getElementById('service-image');
                    if (serviceImage && data.service_image_url) {
                        serviceImage.src = data.service_image_url;
                    }
                }
            }

            async function loadPromotionPopup() {
                const now = new Date().toISOString();
                const { data, error } = await supabase.from('promotions').select('title, image_url, link_url').eq('is_active', true).or(`start_date.is.null,start_date.lte.${now}`).or(`end_date.is.null,end_date.gte.${now}`).order('display_order', { ascending: true }).limit(1).maybeSingle();
                if (error) { console.error('Lỗi khi tải dữ liệu quảng cáo:', error.message); return; }
                if (data && data.image_url) {
                    const promoImageLink = document.getElementById('promo-image-link');
                    const promoImage = document.getElementById('promo-image');
                    const promoButton = document.getElementById('promo-button');
                    const promoPopup = document.getElementById('promotionPopup');
                    const linkUrl = data.link_url || '#';
                    promoImage.src = data.image_url;
                    promoImageLink.href = linkUrl;
                    if (data.title) {
                        promoButton.textContent = data.title;
                        promoButton.href = linkUrl;
                        promoButton.style.display = 'inline-block';
                    } else {
                        promoButton.style.display = 'none';
                    }
                    if (promoPopup && !sessionStorage.getItem('promoShown')) {
                        setTimeout(() => {
                            promoPopup.classList.add('show');
                            sessionStorage.setItem('promoShown', 'true');
                        }, 500);
                    }
                }
            }
            
            async function loadSliders() {
                const { data, error } = await supabase.from('sliders').select('title, subtitle, image_url, button_text, button_link').eq('is_active', true).order('display_order', { ascending: true });
                if (error) { console.error('Lỗi khi tải sliders:', error.message); return; }
                if (data && data.length > 0) { renderSliders(data); }
            }

            function renderSliders(sliders) {
                const indicatorsContainer = document.getElementById('slider-indicators');
                const innerContainer = document.getElementById('slider-inner');
                indicatorsContainer.innerHTML = '';
                innerContainer.innerHTML = '';
                sliders.forEach((slider, index) => {
                    indicatorsContainer.innerHTML += `<button type="button" data-bs-target="#heroSlider" data-bs-slide-to="${index}" class="${index === 0 ? 'active' : ''}" aria-current="${index === 0 ? 'true' : 'false'}" aria-label="Slide ${index + 1}"></button>`;
                    innerContainer.innerHTML += `
                        <div class="carousel-item ${index === 0 ? 'active' : ''}" style="background-image: url('${slider.image_url}')">
                            <div class="carousel-caption">
                                ${slider.title ? `<h1 class="display-3">${slider.title}</h1>` : ''}
                                ${slider.subtitle ? `<p class="lead my-4">${slider.subtitle}</p>` : ''}
                                ${slider.button_text && slider.button_link ? `<a href="${slider.button_link}" target="_blank" rel="noopener noreferrer" class="btn btn-gradient btn-lg">${slider.button_text}</a>` : ''}
                            </div>
                        </div>`;
                });
                if (document.getElementById('heroSlider') && sliders.length > 1) { new bootstrap.Carousel(document.getElementById('heroSlider'), { interval: 5000, ride: 'carousel', pause: false }); }
            }

            async function loadCourses() {
                const { data, error } = await supabase.from('courses').select('*').order('created_at', { ascending: false }).limit(4);
                if (error) { console.error('Lỗi khi tải khóa học:', error.message); return; }
                if (data && data.length > 0) renderCourses(data);
            }

            function renderCourses(courses) {
                const coursesListContainer = document.getElementById('courses-list');
                coursesListContainer.innerHTML = '';
                courses.forEach(course => {
                    const formatPrice = (price) => price ? price.toLocaleString('vi-VN', { style: 'currency', currency: 'VND' }) : '0 đ';
                    const salePriceText = course.price_sale > 0 ? formatPrice(course.price_sale) : 'Miễn phí';
                    const salePriceClass = course.price_sale > 0 ? 'sale-price' : 'sale-price text-success fw-bold';
                    const originalPriceDisplay = course.price_original && course.price_sale > 0 && course.price_original > course.price_sale ? `<span class="original-price">${formatPrice(course.price_original)}</span>` : '';
                    let typeIconClass = `fas ${course.course_type === 'Miễn phí' ? 'fa-gift' : (course.course_type === 'Nâng cao' ? 'fa-rocket' : 'fa-layer-group')}`;
                    coursesListContainer.innerHTML += `
                        <div class="col-lg-3 col-md-6 d-flex">
                            <div class="course-card">
                                <a href="${course.course_link || '#'}" class="course-card-thumbnail">
                                    <img src="${course.image_url || 'https://placehold.co/400x300/cccccc/ffffff?text=Image'}" alt="${course.title || ''}">
                                    ${course.course_type !== 'Miễn phí' ? '<span class="crown-icon"><i class="fas fa-crown"></i></span>' : ''}
                                </a>
                                <div class="course-card-body">
                                    <div class="course-card-meta mb-2">
                                        <span class="info-item"><i class="fas fa-user-circle"></i> ${course.instructor_name || 'N/A'}</span>
                                        <span class="info-item"><i class="${typeIconClass}"></i> ${course.course_type || 'N/A'}</span>
                                    </div>
                                    <h3 class="course-card-title"><a href="${course.course_link || '#'}">${course.title || ''}</a></h3>
                                    <div class="mt-auto pt-3 border-top">
                                        <div class="d-flex justify-content-between align-items-center mb-3">
                                            <span class="fw-bold text-secondary fs-6">Giá:</span>
                                            <div class="course-card-price">${originalPriceDisplay}<span class="${salePriceClass}">${salePriceText}</span></div>
                                        </div>
                                        <a href="${course.course_link || '#'}" class="btn btn-gradient w-100">Xem chi tiết</a>
                                    </div>
                                </div>
                            </div>
                        </div>`;
                });
            }

            // START: CẬP NHẬT HIỆU ỨNG SLIDER
            new Swiper('.testimonials-slider', {
                speed: 1000, // Tăng tốc độ chuyển cảnh
                loop: true,
                grabCursor: true, // Thêm con trỏ hình bàn tay
                centeredSlides: true, // Luôn đưa slide active vào giữa
                autoplay: { 
                    delay: 5000, 
                    disableOnInteraction: false 
                },
                slidesPerView: 1,
                pagination: { 
                    el: '.swiper-pagination', 
                    clickable: true 
                },
                navigation: { 
                    nextEl: '.swiper-button-next', 
                    prevEl: '.swiper-button-prev' 
                },
                breakpoints: { 
                    768: { 
                        slidesPerView: 2, 
                        spaceBetween: 20 
                    }, 
                    992: { 
                        slidesPerView: 3, 
                        spaceBetween: 30 
                    } 
                }
            });
            // END: CẬP NHẬT HIỆU ỨNG SLIDER

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });

            function initializeScrollAnimations() {
                document.querySelectorAll('.section-title, .section-subtitle, .service-item, .course-card, .testimonial-card, .central-hand-image').forEach(el => {
                    el.classList.add('animate-on-scroll');
                    observer.observe(el);
                });
            }

            function setupPopupCloseActions() {
                const promoPopup = document.getElementById('promotionPopup');
                const closePromo = document.getElementById('closePromoPopup');
                if (promoPopup && closePromo) {
                    const close = () => promoPopup.classList.remove('show');
                    closePromo.addEventListener('click', close);
                    promoPopup.addEventListener('click', (e) => { if (e.target === promoPopup) close(); });
                    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') close(); });
                }
            }
            
            async function initializePage() {
                await Promise.all([
                    loadServiceImage(), 
                    loadSliders(), 
                    loadCourses(),
                    loadPromotionPopup()
                ]);
                setTimeout(initializeScrollAnimations, 100);
            }

            initializePage();
            setupPopupCloseActions();
        });
        
        window.addEventListener('load', function() {
            const preloader = document.getElementById('preloader');
            if (preloader) {
                setTimeout(() => {
                    preloader.classList.add('fade-out');
                    preloader.addEventListener('transitionend', () => preloader.style.display = 'none');
                }, 200);
            }
        });
    </script>
</body>

</html>
